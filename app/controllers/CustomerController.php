<?php
require_once __DIR__.'/../lib/session.php';require_once __DIR__.'/../lib/auth.php';require_once __DIR__.'/../lib/db.php';require_once __DIR__.'/../lib/util.php';
function customer_index(){require_login();$pdo=DB::pdo();if($_SERVER['REQUEST_METHOD']==='POST'){$dni=trim($_POST['dni']??'');$nombre=trim($_POST['nombre']??'');$telefono=trim($_POST['telefono']??'');$correo=trim($_POST['correo']??'');if($dni&&$nombre){$st=$pdo->prepare('INSERT INTO cliente(dni,nombre,telefono,correo) VALUES (?,?,?,?) ON DUPLICATE KEY UPDATE nombre=VALUES(nombre),telefono=VALUES(telefono),correo=VALUES(correo)');$st->execute([$dni,$nombre,$telefono,$correo]);}}$rows=$pdo->query('SELECT dni,nombre,telefono,correo FROM cliente ORDER BY nombre')->fetchAll();include __DIR__.'/../views/customer_index.php';}
function customer_delete(){require_login();$pdo=DB::pdo();$dni=$_GET['dni']??'';$st=$pdo->prepare('DELETE FROM cliente WHERE dni=?');$st->execute([$dni]);header('Location: index.php?r=customer/index');}
